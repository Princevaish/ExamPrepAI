{% extends "account/base.html" %}
{% load i18n %}
{% load account socialaccount %}

{% block head_title %}{% trans "Sign In" %}{% endblock %}

{% block content %}

<div class="text-center mb-4">
  <h3 class="text-white-soft mb-2">Welcome Back</h3>
  <p class="text-muted-custom">Sign in to continue your learning journey</p>
</div>

<!-- Google Sign In (Primary) -->
{% get_providers as socialaccount_providers %}

{% if socialaccount_providers %}
  <div class="mb-4">
    {% include "socialaccount/snippets/provider_list.html" with process="login" %}
  </div>
{% endif %}

<!-- Divider -->
{% if form %}
<div class="divider">
  <span>or continue with email</span>
</div>

<!-- Email/Password Form (Fallback) -->
<form class="login" method="POST" action="{% url 'account_login' %}">
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger" role="alert">
      {{ form.non_field_errors }}
    </div>
  {% endif %}

  <div class="mb-3">
    <label for="{{ form.login.id_for_label }}" class="form-label">
      {% trans "Email or Username" %}
    </label>
    <input type="text" 
           name="{{ form.login.name }}" 
           class="form-control {% if form.login.errors %}is-invalid{% endif %}"
           id="{{ form.login.id_for_label }}"
           placeholder="Enter your email"
           value="{{ form.login.value|default:'' }}"
           required>
    {% if form.login.errors %}
      <div class="invalid-feedback">
        {{ form.login.errors }}
      </div>
    {% endif %}
  </div>

  <div class="mb-3">
    <label for="{{ form.password.id_for_label }}" class="form-label">
      {% trans "Password" %}
    </label>
    <input type="password" 
           name="{{ form.password.name }}" 
           class="form-control {% if form.password.errors %}is-invalid{% endif %}"
           id="{{ form.password.id_for_label }}"
           placeholder="Enter your password"
           required>
    {% if form.password.errors %}
      <div class="invalid-feedback">
        {{ form.password.errors }}
      </div>
    {% endif %}
  </div>

  <div class="mb-3 form-check">
    <input type="checkbox" 
           name="{{ form.remember.name }}" 
           class="form-check-input" 
           id="{{ form.remember.id_for_label }}">
    <label class="form-check-label text-white-soft" for="{{ form.remember.id_for_label }}">
      {% trans "Remember Me" %}
    </label>
  </div>

  {% if redirect_field_value %}
    <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
  {% endif %}

  <button type="submit" class="btn btn-neon w-100 mb-3">
    {% trans "Sign In" %}
  </button>

  <div class="text-center">
    <a href="{% url 'account_reset_password' %}" class="text-muted-custom small">
      {% trans "Forgot Password?" %}
    </a>
  </div>

</form>
{% endif %}

<div class="text-center mt-4">
  <p class="text-muted-custom small">
    {% blocktrans %}Don't have an account?{% endblocktrans %}
    <a href="{% url 'account_signup' %}" class="fw-semibold">{% trans "Sign Up" %}</a>
  </p>
</div>

{% endblock %}